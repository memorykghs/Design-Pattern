# 16 - 觀察者模式 ( Observer )

## Observer Pattern 
又稱發布-訂閱 ( Publish/Subscribe ) 模式。定義一種一對多的依賴關係，一個主題對象可被多個觀察者對象同時監聽，使得每當主題對象狀態變化時，所有依賴於它的對象都會得到通知並被自動更新。

![](/images/16-1.png)

觀察者模式的核心：將觀察者與被觀察者解耦。

###### 適用場景
* 當一個抽象模型包含兩個方面內容，其中一個方面依賴於另一個方面。
* 其他一個或多個對象的變化依賴於另一個對象的變化。
* 實現類似廣播機制的功能，無需知道具體收聽者，只需分發廣播，系統中感興趣的對象會自動接收該廣播。
* 多層級嵌套使用，形成一種鏈式觸發機制，使得事件具備跨域 ( 跨越兩種觀察者類型 ) 通知。

## UML
![](/images/16-2.png)

## 實際應用

## 實作

## 小結

#### 優點
* 觀察者和被觀察者是松耦合 ( 抽象耦合 ) 的，符合依賴倒置原則。
* 分離了表示層 ( 觀察者 ) 和數據邏輯層 ( 被觀察者 ) ，並且建立了一套觸發機制，使得數據的變化可以響應到多個表示層上。
* 實現了一對多的通訊機制，支援事件註冊機制，支援興趣分發機制，當被觀察者觸發事件時，只有感興趣的觀察者可以接收到通知。

#### 缺點
* 如果觀察者數量過多，則事件通知會耗時較長。
* 事件通知呈線性關係，如果其中一個觀察者處理事件卡殼，會影響後續的觀察者接收該事件。
* 如果觀察者和被觀察者之間存在循環依賴，則可能造成兩者之間的循環調用，導致系統崩潰。

## 參考
* https://codingnote.cc/zh-tw/p/83149/
* [Observer Pattern](https://www.youtube.com/watch?v=_BpmfnqjgzQ&list=PLrhzvIcii6GNjpARdnO4ueTUAVR9eMBpc&index=2)